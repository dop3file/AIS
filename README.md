# 🎵 University Audio System (AIS)

Система управления аудиотрансляциями для университетских кампусов с поддержкой зонирования, планирования уведомлений и аналитики.

## 📋 Содержание

- [Обзор](#обзор)
- [Возможности](#возможности)
- [Технологический стек](#технологический-стек)
- [Архитектура](#архитектура)
- [Быстрый старт](#быстрый-старт)
- [Использование](#использование)
- [Мониторинг и аналитика](#мониторинг-и-аналитика)
- [API документация](#api-документация)

## 🎯 Обзор

University Audio System (AIS) - это комплексное решение для управления аудиотрансляциями в образовательных учреждениях. Система позволяет загружать аудиофайлы, управлять зонами вещания, планировать уведомления и отслеживать метрики производительности.

## ✨ Возможности

### Управление аудио
- 📤 Загрузка аудиофайлов с автоматическим сохранением в S3-совместимое хранилище
- 🎧 Предпросмотр и воспроизведение загруженных файлов
- 🗑️ Удаление аудиофайлов

### Управление зонами вещания
- 📍 Создание и редактирование зон вещания
- 🏢 Привязка зон к физическим локациям
- 📝 Описание и метаданные для каждой зоны

### Система уведомлений
- ⏰ Планирование уведомлений с указанием времени
- 🎯 Привязка уведомлений к конкретным зонам и аудиофайлам
- 📊 Отслеживание статуса уведомлений (pending, sent, failed)

### Аналитика и мониторинг
- 📈 **Metabase** - бизнес-аналитика с готовыми дашбордами
- 📊 **Grafana** - визуализация метрик производительности API
- 🔍 **Prometheus** - сбор и хранение метрик

## 🛠 Технологический стек

### Backend
- **FastAPI** - современный веб-фреймворк для Python
- **SQLAlchemy** - ORM для работы с базой данных
- **PostgreSQL** - реляционная база данных
- **MinIO** - S3-совместимое объектное хранилище
- **Alembic** - миграции базы данных

### Frontend
- **React** - библиотека для построения пользовательских интерфейсов
- **Vite** - быстрый инструмент сборки
- **Axios** - HTTP-клиент
- **React Icons** - иконки

### Мониторинг
- **Prometheus** - система мониторинга и алертинга
- **Grafana** - платформа для визуализации метрик
- **Metabase** - инструмент бизнес-аналитики

### DevOps
- **Docker** - контейнеризация приложений
- **Docker Compose** - оркестрация контейнеров

## 🏗 Архитектура

```
┌─────────────────────────────────────────────────────────────┐
│                        Frontend (React)                      │
│                     http://localhost:5173                    │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────────────┐
│                    Backend API (FastAPI)                     │
│                     http://localhost:8000                    │
│                      /api/v1/* endpoints                     │
│                      /metrics (Prometheus)                   │
└──────┬──────────┬──────────┬──────────────────┬─────────────┘
       │          │          │                  │
       ▼          ▼          ▼                  ▼
┌──────────┐ ┌────────┐ ┌────────────┐ ┌──────────────┐
│PostgreSQL│ │ MinIO  │ │Prometheus  │ │   Metabase   │
│   :5433  │ │ :9000  │ │   :9091    │ │    :3000     │
└──────────┘ └────────┘ └──────┬─────┘ └──────────────┘
                                │
                                ▼
                         ┌──────────────┐
                         │   Grafana    │
                         │    :3001     │
                         └──────────────┘
```

## 🚀 Быстрый старт

### Предварительные требования

- Docker Desktop
- Docker Compose
- Git

### Установка и запуск

1. **Клонируйте репозиторий**
```bash
git clone <repository-url>
cd AIS
```

2. **Запустите все сервисы**
```bash
docker compose up -d --build
```

3. **Дождитесь запуска всех контейнеров**
```bash
docker ps
```

Вы должны увидеть 7 запущенных контейнеров:
- `ais_backend` - Backend API
- `ais_frontend` - Frontend приложение
- `ais_db` - PostgreSQL база данных
- `ais_minio` - S3 хранилище
- `ais_metabase` - Аналитика
- `ais_prometheus` - Сбор метрик
- `ais_grafana` - Визуализация метрик

## 💻 Использование

### Работа с аудиофайлами

1. Откройте **Audio Library** в веб-интерфейсе
2. Нажмите **Upload Audio** для загрузки файла
3. Выберите аудиофайл с вашего компьютера
4. Файл автоматически загрузится в систему и будет доступен для использования

### Управление зонами вещания

1. Перейдите в раздел **Broadcast Zones**
2. Нажмите **Create Zone**
3. Заполните информацию:
   - **Name** - название зоны
   - **Location** - физическое расположение
   - **Description** - описание зоны
4. Сохраните зону

### Создание уведомлений

1. Откройте раздел **Notifications**
2. Нажмите **Schedule Notification**
3. Выберите:
   - **Audio File** - аудиофайл для воспроизведения
   - **Zone** - зону вещания
   - **Scheduled Time** - время воспроизведения
   - **Message** - текстовое сообщение (опционально)
4. Создайте уведомление

## 📊 Мониторинг и аналитика

### Metabase - Бизнес аналитика

**URL:** http://localhost:3000

Готовый дашборд **"System Overview"** включает:
- 📊 Общее количество зон
- 🎵 Общее количество аудиофайлов
- 📢 Общее количество уведомлений
- 📈 Типы аудиофайлов (Pie Chart)
- 📊 Статусы уведомлений (Bar Chart)
- 📋 Последние загруженные файлы
- 📋 Последние уведомления

### Grafana - Метрики производительности

**URL:** http://localhost:3001

Автоматически настроенный дашборд **"University Audio System - API Metrics"**:
- 🚀 HTTP Request Rate - частота запросов
- ⏱️ 95th Percentile Response Time - время отклика
- 📊 Requests by HTTP Method - распределение по методам
- 📈 Requests by Status Code - распределение по кодам ответа
- 📉 Requests by Endpoint - нагрузка на эндпоинты

### Prometheus - Сбор метрик

**URL:** http://localhost:9091

Доступные метрики:
- `http_requests_total` - общее количество запросов
- `http_request_duration_seconds` - длительность запросов
- Метрики по эндпоинтам, методам и статус-кодам

### Структура проекта

```
AIS/
├── app/                          # Backend приложение
│   ├── api/                      # API endpoints
│   │   └── v1/
│   │       └── endpoints/        # Версия 1 API
│   ├── core/                     # Конфигурация
│   ├── models/                   # SQLAlchemy модели
│   ├── schemas/                  # Pydantic схемы
│   └── services/                 # Бизнес-логика
├── frontend/                     # React приложение
│   ├── src/
│   │   ├── components/           # React компоненты
│   │   ├── pages/                # Страницы
│   │   └── services/             # API клиент
├── grafana/                      # Grafana конфигурация
│   ├── dashboards/               # JSON дашборды
│   └── provisioning/             # Автоматическая настройка
├── scripts/                      # Утилиты
├── alembic/                      # Миграции БД
├── docker-compose.yml            # Docker конфигурация
├── prometheus.yml                # Prometheus конфигурация
└── requirements.txt              # Python зависимости
```
